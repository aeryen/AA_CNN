STATISTICSINMEDICINE,VOL.16,385â€”395(1997)THELASSOMETHODFORVARIABLESELECTIONINTHECOXMODELROBERTTIBSHIRANIDepartmentofPreventiveMedicineandBiostatisticsandDepartmentofStatistics,UniversityofToronto,Toronto,Ontario,CanadaM5S1A8SUMMARYIproposeanewmethodforvariableselectionandshrinkageinCoxâ€™sproportionalhazardsmodel.Myproposalminimizesthelogpartiallikelihoodsubjecttothesumoftheabsolutevaluesoftheparametersbeingboundedbyaconstant.Becauseofthenatureofthisconstraint,itshrinkscoeï¬ƒcientsandproducessomecoeï¬ƒcientsthatareexactlyzero.Asaresultitreducestheestimationvariancewhileprovidinganinterpretableï¬nalmodel.Themethodisavariationoftheâ€˜lassoâ€™proposalofTibshirani,designedforthelinearregressioncontext.Simulationsindicatethatthelassocanbemoreaccuratethanstepwiseselectioninthissetting.1.INTRODUCTIONConsidertheusualsurvivaldatasetup.Thedateavailableareoftheform(y,x,â™¥),2,(y,,x,,â™¥,),thesurvivaltimeyGbeingcompleteifâ™¥G"1andrightcensoredifâ™¥G"0,withxGdenotingtheusualvectorofpredictors(x,x,2,xN)fortheithindividual.Denotethedistinctfailuretimesbyt(2(tI,therebeingdGfailuresattimetG.Theproportional-hazardsmodelforsurvivaldata,alsoknownastheCoxmodel,assumesthatâ™®(t"x)"â™®(t)exp	HxHâ™¢H(1)whereâ™®(t"x)isthehazardattimetgivenpredictorvaluesx"(x,2,xN),andâ™®(t)isanarbitrarybaselinehazardfunction.Oneusuallyestimatestheparameterâ™¢"(â™¢,â™¢,2,â™¢N)2intheproportional-hazardsmodel(1)withoutspeciï¬cationofâ™®(t)throughmaximizationofthethepartiallikelihoodÂ¸(â™¢)"Â“PZ"exp(â™¢2xjP)+	j3RPexp(â™¢2xH),.(2)Inequation(2)Disthesetofindicesofthefailures,RPisthesetofindicesoftheindividualsatriskattimetP!0,andjPistheindexofthefailureattimetP.Assumeforsimplicitythattherearenotiedfailuretimes;suitablemodiï¬cationsofthepartiallikelihoodexistforthecaseofties.Assumealsothatthecensoringisnon-informative,sothattheconstructionofthepartiallikelihoodisjustiï¬ed.CCC0277â€”6715/97/040385â€”11ReceivedMarch19951997byJohnWiley&Sons,Ltd.RevisedDecember1995Denotethelogpartiallikelihoodbyl(â™¢)"logÂ¸(â™¢),andassumethatthexGHarestandardizedsothat	GxGH/N"0,	GxGH/N"1.InthispaperIproposetoestimateâ™¢viathecriterionâ™¢K"argminl(â™¢),subjectto	"â™¢H")s(3)wheres'0isauser-speciï¬edparameter.Inthelinearregressionsetting,Tibshiraniproposedminimizationoftheresidualsumofsquares,subjecttoaconstraintoftheform	"â™¢H")sandcalledtheresultingproceduretheâ€˜lassoâ€™forâ€˜LeastAbsoluteShrinkageandSelectionOperatorâ€™.HereIusethetermâ€˜lassoâ€™forthepresentproposalaswell.Supposeâ™¢KMHarethemaximizersofthepartiallikelihood(2).Thenifs*	"â™¢KMH",thesolutionsto(3)aretheusualpartiallikelihoodestimates.Ifs(	"â™¢KMH",however,thenthesolutionsto(3)areshrunkentowardszero.Anattractivefeatureoftheparticularconstraint	"â™¢H")sisthatquiteoftensomeofthesolutioncoeï¬ƒcientsareexactlyzero.Thismakesforamoreinterpretableï¬nalmodel.Ontheotherhand,thesmoothformoftheconstraintshouldprovideamorestableï¬nalmodelthanthatgivenbystepwiseorbestsubsetselection.Intheregressionsetting,Tibshiraniconï¬rmedthisinsimulationstudies.Incontrast,theridgeregressionapproach(usedmainlyinthelinearmodelsetting)shrinkscoeï¬ƒcientsbutdoesnotgivecoeï¬ƒcientsthatareexactlyzero.Notethatlikemodelselection,thelassoisatoolforachievingparsimony;inactualityanexactzerocoeï¬ƒcientisunlikelytooccur.Thenextsectiongivesanalgorithmforobtainingthelassoestimates.Section3containstworealdataexamples.AutomaticestimationoftheconstraintparametersappearsinSection4,andinSection5Ireportasimulationstudythatcomparesthelassotostepwiseselection.Section6discussesestimationofstandarderrors,whileSection7containssomediscussion,includingabriefsummaryofotherapproachestomodelselection.2.COMPUTATIONOFTHEESTIMATESTibshiranigavetwoalgorithmsforthelassoprocedureintheleastsquaresregressionsetting,basedonquadraticprogrammingtechniques.Thealgorithmsareiterativeandinvolverepeatedsolutionofleastsquaresproblems.Typicallyoneneedsbetweenpand2piterations,wherepisthenumberofregressorvariables.Thestrategyforsolving(3)istoexpresstheusualNewtonâ€”Raphsonupdateasaniterativereweightedleastsquares(IRLS)step,andthenreplacetheweightedleastsquaresstepbyaconstrainedweightedleastsquaresprocedure.IfXdenotesthedesignmatrixofregressorvariablesandâ™ª"Xâ™¢,deï¬neu"*l/*â™ª,A"!*l/*â™ªâ™ª2andz"â™ª#A\u(detailedexpressionsforu,AandzappearinHastieandTibshirani,Chapter8,pp.213â€”214).Thenaone-termTaylorseriesexpansionforl(â™¢)hastheform(z!â™ª)2A(z!â™ª).(4)Hencetosolvetheoriginalproblem(3),weusethefollowingprocedure:1.Fixsandinitializeâ™¢K"0.2.Computeâ™ª,u,Aandzbasedonthecurrentvalueofâ™¢K.3.Minimize(z!Xâ™¢)2A(z!Xâ™¢)subjectto	"â™¢G")s.4.Repeatsteps2and3untilâ™¢Kdoesnotchange.Theminimizationinstep3isdonethroughaquadraticprogrammingprocedure,asdescribedinTibshirani.Notethatifoneusedinsteadanunconstrainedminimizationinstep3,thisprocedure386R.TIBSHIRANIwouldbeequivalenttotheusualNewtonâ€”Raphsonalgorithmformaximizingthepartiallikelihood(HastieandTibshirani,Chapter8,p.212).Onediï¬ƒcultywiththeaboveprocedureisthatAisafullmatrixandhenceitrequirescomputationofO(N)elements.Onecanavoidthis,howeverby,replacingAwithadiagonalmatrixDthathasthesamediagonalelementsasA.AsarguedinHastieandTibshirani(Chapter8,pp.212â€”213),thediagonalelementsofAarelargerthantheoï¬€-diagonalelementsandhencethemodiï¬edalgorithmshouldbehavesimilarlytotheoriginalone.ThereisnointerceptintheCoxmodelandhencetheminimizationinstep3doesnotrequireanintercept.Ihavefoundhoweverthatinclusionofaninterceptdramaticallyimprovestheconvergenceoftheprocedure.Thisispurelyacomputationalissue;itmakesnodiï¬€erenceintheï¬nalmodel,astheinterceptisabsorbedintothebaselinehazard.Ifthelogpartiallikelihoodisboundedinâ™¢forthegivendataset,thenforï¬xedsasolutionto(3)existssincetheregion	"â™¢H")siscompact.However,thesolutionmaynotbeunique.Forexample,iftworegressorsvariablesXandXareidenticallyequal,thenifâ™¢'0,foranyâ™¤in[0,â™¢]thelinearcombinationXâ™¤#(â™¢!â™¤)Xhasexactlythesamevalueforthelandtheconstraint"â™¤"#"â™¢!â™¤".Notethatthisisduetothelinearityoftheconstraint;inridgestylepenalizationinvolvingthesquaredcoeï¬ƒcients,thisdoesnotoccur.3.EXAMPLES3.1.LungcancerdataThedatainthisexamplecomefromtheVeteranâ€™sAdministrationlungcancertrial,listedinKalbï¬‚eischandPrentice,pp.223â€”224.Thetimevariableissurvivalindays,andtheregressorsare:1.Treatment1"standard,2"test.2.Celltype1"squamous,2"smallcell,3"adeno,4"large.3.Karnofskyscore.4.Monthsfromdiagnosis.5.Ageinyears.6.Priortherapy0"no,10"yes.Forsimplicity,andbecausethecategoriesexhibitincreasingrisk,Ihaveleftcelltypeasanumericalvariable.AstandardproportionalhazardsanalysisshowsthattheKarnofskyscoreisextremelyimportant,whilecelltypeisalsostronglysigniï¬cant.Theotherregressorsshowmoderateeï¬€ects.Figure1showstheestimatedcoeï¬ƒcientsfromthelassoï¬tasafunctionofthestandardizedconstraintparameteru"s/	"â™¢KMH"(whereâ™¢MHaretheunconstrainedpartiallikelihoodestimates).Karnofskyscoreisclearlythedominanteï¬€ectwithtreatmentandcelltypealsoshowingmoderateinï¬‚uence.Theverticalbrokenlineisdrawnat0Â·45,whichisthevalueofuchosenbygeneralizedcross-validation(GCV,seeSection4).Themodelselectedbygeneralizedcross-validationhasanon-zerocoeï¬ƒcientonlyforKarnofskyscore,withacoeï¬ƒcientof!0Â·47,correspondingtoarelativeriskof0Â·63.Itstandarderroris0Â·085,computedbythetechniquediscussedinSection6.BackwardstepwiseselectioninthestandardCoxmodelyieldsthesamesinglevariablemodel,butwithacoeï¬ƒcientof!0Â·67(0Â·10)orarelativerisk0Â·51.Thestepwisemethodreferstobackwardâ€”forwardstepwiseselectionasimplementedinScottEmersonâ€™sSlanguagefunctionâ€˜coxrgrssâ€™withthedefaultP-valuestoenterandremoveof0Â·05and0Â·10,respectively.IalsoappliedSchwarzâ€™scriterions(alsoknownasBIC)tothesedata;thishastheTHELASSOMETHODFORVARIABLESELECTIONINTHECOXMODEL387Figure1.Coeï¬ƒcientestimatesforlungcancerexample,asafunctionofthestandardizedconstraintparameteru"s/	"â™¢KMH"formminuslogpartiallikelihoodplusklognwherekisthenumberofregressorsinthemodelconsideredandnisthesamplesize.Searchingoverallsubsets,themodelthatminimizesSchwarzâ€™scriterionagaincontainedonlytheKarnofskyscore.3.2.LiverdataThedatainthisexampleandthefollowing(edited)descriptionwereprovidedbyHarringtonandFleming.â€˜Primarybiliarycirrhosis(PBC)oftheliverisararebutfatalchronicliverdiseaseofunknowncause,withaprevalenceofabout50-cases-per-millionpopulation.Theprimarypathologiceventappearstobethedestructionofinterlobularbileducts,whichmaybemediatedbyimmunologicmechanisms.388R.TIBSHIRANIThefollowingbrieï¬‚ydescribesdatacollectedfortheMayoClinictrialinPBCoftheliverconductedbetweenJanuary1974andMay1984comparingthedrugD-penicillamine(DPCA)withaplacebo.Theï¬rst312casesparticipatedintherandomizedtrialofD-penicillamineversusplacebo,andcontainlargelycompletedata.Anadditional112casesdidnotparticipateintheclinicaltrial,butconsentedtohavebasicmeasurementsrecordedandtobefollowedforsurvival.Sixofthosecaseswerelosttofollow-upshortlyafterdiagnosis,sotherearedatahereonanadditional106casesaswellasthe312randomizedparticipants.â€™Idiscardedobservationswithmissingvalues,leaving276observations.Thevariablesinthedatasetare:NCasenumber.Â½Thenumberofdaysbetweenregistrationandtheearlierofdeathorstudyanalysistimein1986.â™¥1ifÂ½istimetodeath,0iftimetocensoring.XTreatmentcode,1"D-pencillamine,2"placebo.XAgeinyears.Fortheï¬rst312cases,agewascalculatedbydividingthenumberofdaysbetweenbirthandstudyregistrationby365.XSex,0"male,1"female.XPresenceofascites,0"no,1"yes.XPresenceofhepatomegaly,0"no,1"yes.XPresenceofspiders,0"no,1"yes.XPresenceofoedema,0"no,0Â·5"yesbutrespondedtodiuretictreatment,1"yes,didnotrespondtotreatment.XSerumbilirubin,inmg/dl.XSerumcholesterol,inmg/dl.XAlbumin,ing/dl.XUrinecopper,inâ™¯g/day.XAlkalinephosphatase,inU/litre.XSGOT,inU/ml.XTriglycerides,inmg/dl.XPlateletcount;codedvalueisnumberofplateletspercubicmlofblooddividedby1000.XProthrombinetime,inseconds.XHistologicstateofdisease,graded1,2,3or4.SomeresultsappearinTableI.Thestepwisemethodreferstobackwardâ€”forwardstepwiseselectionasimplementedinScottEmersonâ€™sSlanguagefunctionâ€˜coxrgrssâ€™withthedefaultP-valuestoenterandremoveof0Â·05and0Â·10respectively.CoxrgrssisavailablefromtheStatlibarchive(ftpsitelib.stat.cmu.edu).Thisgaveamodelwitheightvariables,allhavinglargeZ-scores.TheGCVproceduregaveuL"0Â·56forthestandardizedlassoparameterandtheresultingmodelfromthelassolookssimilartothestepwisemodel,withmostoftheeï¬€ectsshrunkentowardszero.Whilethestepwiseprocedureofteninï¬‚atestheZscoresofchosenvariablesrelativetothefullmodelï¬t,thelassoseemstoshrinkthemtowardszero.IcomputedstandarderrorsforthelassoestimatesusingthemethodgiveninSection6.4.ESTIMATIONOFTHECONSTRAINTPARAMETERsInsomesituationsitisdesirabletohaveanautomaticmethodforchoosingsbasedonthedata.Suchaprocedureisanalogoustoanautomaticsubsetselectionproceduresuchasforward,backwardorallsubsetsregression.THELASSOMETHODFORVARIABLESELECTIONINTHECOXMODEL389TableI.ResultsforliverdataexampleVariablesFullStepwiseLassoCoeï¬ƒcientSEZ-scoreCoeï¬ƒcientSEZ-scoreCoeï¬ƒcientSEZ-score1!0Â·060Â·11!0Â·58â€”â€”â€”0Â·000Â·000Â·0020Â·300Â·122Â·490Â·330Â·113Â·080Â·170Â·091Â·893!0Â·120Â·10!1Â·17â€”â€”â€”!0Â·010Â·03!0Â·3140Â·020Â·100Â·23â€”â€”â€”0Â·040Â·070Â·6350Â·010Â·130Â·10â€”â€”â€”0Â·000Â·000Â·0060Â·050Â·110Â·42â€”â€”â€”0Â·020Â·050Â·4070Â·270Â·112Â·560Â·220Â·092Â·370Â·180Â·111Â·7180Â·370Â·123Â·140Â·390Â·094Â·390Â·350Â·122Â·9790Â·120Â·101Â·11â€”â€”â€”0Â·000Â·010Â·2810!0Â·300Â·12!2Â·40!0Â·290Â·11!2Â·63!0Â·220Â·10!2Â·27110Â·220Â·102Â·130Â·250Â·092Â·900Â·210Â·111Â·98120Â·000Â·080Â·03â€”â€”â€”0Â·000Â·000Â·00130Â·230Â·112Â·080Â·250Â·102Â·420Â·090Â·081Â·0414!0Â·060Â·09!0Â·75â€”â€”â€”0Â·000Â·000Â·00150Â·080Â·110Â·76â€”â€”â€”0Â·000Â·000Â·00160Â·230Â·112Â·190Â·230Â·102Â·250Â·090Â·090Â·97170Â·390Â·152Â·590Â·370Â·122Â·970Â·210Â·092Â·28Myproposalistominimizeanapproximategeneralizedcross-validation(GCV)statistic(Wahba).Toconstructthisstatistic,weneedalinearapproximationtothelassoestimate.Wewritetheconstraint	"â™¢H")sas	â™¢H/"â™¢H")s.ThislatterconstraintisequivalenttoaddingaLagrangianpenaltyâ™®	â™¢H/"â™¢H"tothelogpartiallikelihood,withâ™®*0dependingons.Intuitively,theseareequivalentsincetheybothleadtoabalancebetweenï¬t,asmeasuredbythelogpartiallikelihood,andthevalueofâ™®	â™¢H/"â™¢H".Usingstandardmatrixmanipulations,wemaywritetheconstrainedsolutionâ™¢Iinstep3intheformâ™¢I"(X2DX#â™®W)\X2Dz(5)W"diag(WH),WG"1/"â™¢IH"if"â™¢IH"'0and0otherwise.(Thisexpressiondoesnotgiveanumericallyeï¬€ectivewayofcomputingthelassoestimate,butitisusefulforassessingthecomplexityoftheï¬t.)Thereforewemayapproximatethenumberofeï¬€ectiveparametersintheconstrainedï¬tâ™¢Ibyp(s)"tr[X(X2DX#â™®W\)\X2D].LettinglQbethelog-partiallikelihoodfortheconstrainedï¬twithconstraints,weconstructtheGCV-stylestatisticGCV(s)"1N!lQN[1!p(s)/N].(6)Intuitively,theGCVcriterioninï¬‚atesthenegativelogpartiallikelihoodbyafactorthatinvolvesp(s),theeï¬€ectivenumberofparameters.Largervaluesofp(s)causemoreinï¬‚ation(penalization)ofthenegativelogpartiallikelihood.SeeWahbafordetailsofgeneralizedcross-validation;onecouldalsouseanAkaike-stylecriterion,asinAkaike.Figure2showstheGCVplotforthelungcancerexample,asafunctionofthestandardizedconstraintparameter.Theminimumoccursnearu"0Â·45.390R.TIBSHIRANIFigure2.GCVplotforlungcancerexample.Thegeneralizedcross-validationscoreisplottedagainstthestandardizedconstraintparameteru"s/	"â™¢KMH"5.ASIMULATIONSTUDY5.1.Afewlargeeï¬€ectsInthisexamplewesimulated50datasetseachwith50observations,fromtheexponentialhazardmodelâ™®(t"x)"exp(â™¢2x)whereâ™¢"(!0Â·35,!0Â·35,0,0,0,!0Â·35,0,0,0)2.ThexGwereeachmarginallystandardnormal,andthecorrelationbetweenxGandxHwasâ™µ"i!j"withâ™µ"0Â·5.Thisgavemoderatetostrongeï¬€ectsforthethreeregressorswithnon-zerocoeï¬ƒcients.Letting	bethepopulationcovariancematrixoftheregressors,TableIIshowsthemedianofthemeansquarederrors(â™¢K!â™¢)2	(â™¢K!â™¢)over50simulationsfromthismodel.Asbefore,thestepwisemethodreferstobackwardâ€”forwardstepwiseselectionasimplementedinScottEmersonâ€™sSlanguagefunctionâ€˜coxrgrssâ€™withthedefaultP-valuestoenterandremoveof0Â·05and0Â·10,respectively.Thelassoclearlyoutperformsstepwiseselection,andpicksapproximatelythecorrectnumberofzerocoeï¬ƒcients.Figure3showsboxplotsofthecoeï¬ƒcientsfromeachofthethreemethods.Thelassodoesabetterjobofisolatingthenon-zerocoeï¬ƒcientsandshrinkstheotherssubstantially.5.2.Manysmalleï¬€ectsHereweusedthesamemodelasintheprevioussection,butwithâ™¢H"0Â·1âˆ€H.Thisresultedinanoccasionaleï¬€ectsigniï¬cantatthe0Â·05level,asmeasuredbythefullCoxmodelï¬t.TableIIIshowstheresults.Thelassooutperformsthefullandstepwisemodelsbyshrinkingthecoeï¬ƒcientsalmostallofthewaytozero.THELASSOMETHODFORVARIABLESELECTIONINTHECOXMODEL391TableII.Resultsforexample3(afewlargeeï¬€ects).Meansquarederrors(MSE)over50simulationsMethodMedianMSE(standarderrors)Averagenumbersofzerocoeï¬ƒcientsNull0Â·44(â€”)9Â·0Fullmodel0Â·82(0Â·13)0Â·0Stepwise0Â·63(0Â·12)5Â·6Lasso0Â·26(0Â·07)6Â·7Figure3.Boxplotofcoeï¬ƒcientsfromï¬rstsimulationstudy(afewlargecoeï¬ƒcients)392R.TIBSHIRANITableIII.Resultsforsecondsimulationstudy(manysmalleï¬€ects).Meansquarederrors(MSE)over50simulationsMethodMedianMSE(standarderrors)Averagenumbersofzerocoeï¬ƒcientsNull0Â·15(â€”)9Â·0Fullmodel0Â·57(0Â·04)0Â·0Stepwise0Â·53(0Â·04)5Â·5Lasso0Â·15(0Â·00)7Â·8TableIV.EstimatedandactualstandarderrorsforsimulatedexampleVariableu"0Â·7u"0Â·3Meancoeï¬ƒcientMeanSEYActualSEMeancoeï¬ƒcientMeanSEYActualSE1!0Â·550Â·170Â·19!0Â·300Â·130Â·162!0Â·580Â·180Â·24!0Â·350Â·150Â·173!0Â·010Â·090Â·16!0Â·020Â·020Â·0640Â·010Â·070Â·100Â·000Â·000Â·0150Â·000Â·070Â·13!0Â·010Â·010Â·056!0Â·500Â·160Â·20!0Â·230Â·120Â·127!0Â·050Â·090Â·15!0Â·010Â·010Â·0380Â·000Â·090Â·150Â·000Â·010Â·029!0Â·010Â·060Â·110Â·000Â·000Â·016.STANDARDERRORSWecanuseapproximation(5)toyieldanapproximatemethodforobtainingstandarderrorsforthelassoestimates.Inthenotationofequation(5),wecanshowusingstandardpartiallikelihoodtheorythatthevarianceofzisapproximatelyD\.LettingMdenotethematrixthatmultiplieszinequation(5),thenthevarianceofâ™¢K"MzisapproximatelyMD\M2.Hencewecanobtaintheapproximatestandarderrorsofâ™¢KfromthesquarerootofthediagonalofMD\M2.Toinvestigatetheaccuracyofthisprocedure,Isimulated50datasetsfromtheexampleofSection5.1.Theregressorvariablesweregeneratedonceandï¬xedforthe50simulations.TableIVshowstheresults.Intheleftpartofthetablethestandardizedconstraintparameterwasï¬xedat0Â·7;intherighthalf,itwas0Â·3.Ineachhalf,theï¬rstcolumnshowsthemeancoeï¬ƒcientoverthe50simulations,thesecondcolumngivesthemeanofthestandarderrorestimate,andthethirdcolumnshowstheactualstandarderrorofthecoeï¬ƒcientsoverthe50simulations.Notethatontheaveragethestandarderrorformulagivesareasonableestimateforthelargeeï¬€ects(variables1,2,6).Forthesmalleï¬€ects,ittendstounderestimatethestandarderror,butnotsomuch(exceptinoneinstance)astoaï¬€ectthattheperceivedsigniï¬canceofthevariable.Thustheapproximatestandarderrorsappearreliable,exceptwhentheestimatedcoeï¬ƒcientitselfisverysmall.Notealsothatthesamplingdistributionoftheestimatestendstobeskewed,especiallyforsmallvaluesoftheconstraintparameter(seeFigure3),sothiswilldegradetheaccuracyofnormalconï¬dencelimits.THELASSOMETHODFORVARIABLESELECTIONINTHECOXMODEL3937.DISCUSSIONThelassotechniqueforvariableselectionintheCoxmodelseemsaworthycompetitortostepwiseselection.Itislessvariablethanthestepwiseapproachandstillyieldsinterpretablemodels.Inpracticethelassoshouldbeusedinconjunctionwithothermodelbuildingtools.Inparticular,inourexampleswehaveassumedthatlinearityisreasonableforallofthepredictors.Thismaynotbeagoodassumptionanditshouldbecheckedinarealdataanalysis.Similarly,arefereepointedoutthattheproportionalhazardsassumptionisunreasonableofcelltypeandKarnofskyscoreintheï¬rstexample,andthisshouldbechecked;Ihavenotattemptedtoprovidethoroughanalysesinmyexamples.Thelassomethodrequiresinitialstandardizationoftheregressors,sothatthepenalizationschemeisfairtoallregressors.Forcategoricalregressors,onecodestheregressorwithdummyvariablesandthenstandardizesthedummyvariables.Aspointedoutbyareferee,however,therelativescalingbetweencontinuousandcategoricalvariablesinthisschemecanbesomewhatarbitrary.Insomeproblemstheremightbeeï¬€ectsthattheanalystdoesnotwanttoshrinkatall.Suchanexampleisatreatmentfactorknowntobeeï¬€ectiveapriori,withinterestlyinginmoreaccurateadjustmentforothercovariates.Insuchaninstance,onesimplyomitsthecorrespondingâ™¢Hfromtheconstraint,andonesolvestheproblembyasimplemodiï¬cationoftheoptimizationprocedurediscussedearlier.Therearesomeotherrecentlyproposedapproachestomodelselection.TheBayesianapproachhasbeendevelopedbyMichellandBeauchampandGeorgeandMcCulloch.TheyuseahierarchicalBayesmodel;thesecondauthorsapplytheGibbssamplertosimulatealargecollectionofsubsetmodelsfromtheposteriordistribution.SauerbreiandSchumacherproposeabootstrap-basedapproachtomodelselection.Therearesomewaystoextendthiswork.Thispaperhasfocusedonï¬xedcovariates,butonecanincorporatetime-dependentcovariateswithoutanynewdiï¬ƒculty.Adaptationofthelassotechniquetothematchedcasecontrolmodelsisalsofairlystraightforward.ACKNOWLEDGEMENTSIwishtothankMichaelLeBlancforprovidingFlemingandHarringtonâ€™sliverdata,andMartinSchumacherandtworefereesforhelpfulcomments.ThisworkwassupportedbyagrantfromtheNaturalSciencesandEngineeringResearchCouncilofCanada.REFERENCES1.Cox,D.â€˜Regressionmodelsandlifetables(withdiscussion)â€™,JournaloftheRoyalStatisticalSociety,SeriesB,74,187â€”220(1972).2.Tibshirani,R.â€˜Regressionshrinkageandselectionviathelassoâ€™,JournaloftheRoyalStatisticalSociety,SeriesB,(1995).3.Hastie,T.andTibshirani,R.GeneralizedAdditiveModels,ChapmanandHall,1990.4.Kalbï¬‚eisch,J.andPrentice,R.Â¹heStatisticalAnalysisofFailureÂ¹imeData,Wiley,NewYork,1980.5.Schwarz,G.â€˜Estimatingthedimensionofamodelâ€™,AnnalsofStatistics,6,461â€”464(1978).6.Wahbaâ€˜Splinebases,regularization,andgeneralizedcross-validationforsolvingapproximationproblemswithlargequantitiesofnoisydataâ€™,inProceedingsoftheInternationalConferenceonApproximationtheoryinhonourofGeorgeLorenz,AcademicPress,Austin,Texas,1980.394R.TIBSHIRANI7.Akaike,H.â€˜Informationtheoryandanextensionofthemaximumlikelihoodprincipleâ€™,inSecondInternationalSymposiumonInformationTheory,1973pp.267â€”281.8.Mitchell,T.andBeauchamp,J.â€˜Bayesianvariableselectioninlinearregressionâ€™,JournaloftheAmericanStatisticalAssociation,83,1023â€”1036(1988).9.George,E.andMcCulloch,R.â€˜VariableselectionviaGibbssamplingâ€™,JournaloftheAmericanStatisticalAssociation,88,884â€”889(1993).10.Sauerbrei,W.andSchumacher,M.â€˜Abootstrapresamplingprocedureformodelbuilding:applicationtothecoxregressionmodelâ€™,StatisticsinMedicine,11,2093â€”2109(1992)..THELASSOMETHODFORVARIABLESELECTIONINTHECOXMODEL395